"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[871],{8871:(e,a,l)=>{l.r(a),l.d(a,{default:()=>U});var s=l(1758),i=l(9104),n=l(8790),t=l(8734),o=l(3394),r=(l(199),l(4685));l(780);const d={API_BASE_URL:null,USE_MOCK_DELAY:!0,MOCK_DELAY_MS:300},m=async()=>{d.USE_MOCK_DELAY&&!d.API_BASE_URL&&await new Promise(e=>setTimeout(e,d.MOCK_DELAY_MS))},u=async(e,a={})=>{if(!d.API_BASE_URL)throw new Error("API not configured - using localStorage");const l=`${d.API_BASE_URL}${e}`,s=r.Ht(),i=await fetch(l,{...a,headers:{"Content-Type":"application/json",...s?{Authorization:`Bearer ${s.token}`}:{},...a.headers}});if(!i.ok){const e=await i.json().catch(()=>({message:"Request failed"}));throw new Error(e.message||`HTTP ${i.status}`)}return i.json()},c=async(e,a)=>(await m(),d.API_BASE_URL?u("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:a})}):r.iD(e,a)),p=async()=>(await m(),r.cN()),g={isValidEmail:r.B9,validatePassword:r.Oj},v={class:"login-container"},b={class:"login-card"},_={class:"login-header"},A={class:"logo-section"},k={class:"demo-info"},w={class:"text-center q-mt-lg"},f={__name:"AdminLoginPage",setup(e){const a=(0,o.rd)(),l=(0,t.KR)(""),r=(0,t.KR)(""),d=(0,t.KR)(!1),m=(0,t.KR)(!1),u=(0,t.KR)(!1),f=(0,t.KR)(""),h=(0,t.Kh)({email:"",password:""}),y=()=>{let e=!0;return h.email="",h.password="",l.value?g.isValidEmail(l.value)||(h.email="Please enter a valid email",e=!1):(h.email="Email is required",e=!1),r.value||(h.password="Password is required",e=!1),e},L=async()=>{if(f.value="",y()){m.value=!0;try{const e=await c(l.value,r.value);if("admin"!==e.role)return void(f.value="This account does not have admin privileges");a.push({name:"admin-dashboard"})}catch(e){f.value=e.message||"Login failed. Please try again."}finally{m.value=!1}}},P=async()=>{f.value="",u.value=!0;try{await p(),a.push({name:"admin-dashboard"})}catch(e){f.value=e.message||"Demo login failed. Please try again."}finally{u.value=!1}};return(e,a)=>{const t=(0,s.g2)("q-icon"),o=(0,s.g2)("q-badge"),c=(0,s.g2)("q-input"),p=(0,s.g2)("q-btn"),g=(0,s.g2)("q-form"),y=(0,s.g2)("q-banner"),q=(0,s.g2)("router-link"),E=(0,s.g2)("q-page");return(0,s.uX)(),(0,s.Wv)(E,{class:"admin-login-page"},{default:(0,s.k6)(()=>[(0,s.Lk)("div",v,[(0,s.Lk)("div",b,[(0,s.Lk)("div",_,[(0,s.Lk)("div",A,[(0,s.bF)(t,{name:"admin_panel_settings",size:"48px",color:"deep-purple-9"}),a[4]||(a[4]=(0,s.Lk)("h1",{class:"app-title"},"MyCities",-1)),(0,s.bF)(o,{color:"warning","text-color":"black",class:"q-ml-sm"},{default:(0,s.k6)(()=>[...a[3]||(a[3]=[(0,s.eW)("Admin",-1)])]),_:1})]),a[5]||(a[5]=(0,s.Lk)("p",{class:"subtitle"},"Administrator Portal",-1))]),(0,s.bF)(g,{onSubmit:(0,i.D$)(L,["prevent"]),class:"login-form"},{default:(0,s.k6)(()=>[(0,s.bF)(c,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),type:"email",label:"Admin Email",outlined:"",dense:"",class:"q-mb-md",error:!!h.email,"error-message":h.email,"data-test":"admin-email-input"},{prepend:(0,s.k6)(()=>[(0,s.bF)(t,{name:"email"})]),_:1},8,["modelValue","error","error-message"]),(0,s.bF)(c,{modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value=e),type:d.value?"text":"password",label:"Password",outlined:"",dense:"",class:"q-mb-md",error:!!h.password,"error-message":h.password,"data-test":"admin-password-input"},{prepend:(0,s.k6)(()=>[(0,s.bF)(t,{name:"lock"})]),append:(0,s.k6)(()=>[(0,s.bF)(t,{name:d.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:a[1]||(a[1]=e=>d.value=!d.value)},null,8,["name"])]),_:1},8,["modelValue","type","error","error-message"]),(0,s.bF)(p,{type:"submit",color:"deep-purple-9",class:"full-width q-mb-md",label:"Sign In as Admin",loading:m.value,"data-test":"admin-login-btn"},null,8,["loading"]),(0,s.bF)(p,{flat:"",color:"deep-purple",class:"full-width q-mb-md",label:"Use Demo Admin Account",loading:u.value,onClick:P,"data-test":"admin-demo-btn"},null,8,["loading"])]),_:1}),f.value?((0,s.uX)(),(0,s.Wv)(y,{key:0,class:"bg-negative text-white q-mb-md",rounded:""},{avatar:(0,s.k6)(()=>[(0,s.bF)(t,{name:"error"})]),default:(0,s.k6)(()=>[(0,s.eW)(" "+(0,n.v_)(f.value),1)]),_:1})):(0,s.Q3)("",!0),(0,s.Lk)("div",k,[(0,s.bF)(t,{name:"info",color:"grey-6",size:"sm"}),a[6]||(a[6]=(0,s.Lk)("span",null,"Demo Admin: admin@mycities.co.za / admin123",-1))]),(0,s.Lk)("div",w,[(0,s.bF)(q,{to:"/login",class:"text-deep-purple"},{default:(0,s.k6)(()=>[...a[7]||(a[7]=[(0,s.eW)(" ‚Üê Back to User Login ",-1)])]),_:1})])])])]),_:1})}}};var h=l(2807),y=l(7716),L=l(492),P=l(3954),q=l(9200),E=l(9270),F=l(6384),S=l(6868),R=l(8582),B=l.n(R);const K=(0,h.A)(f,[["__scopeId","data-v-046aecaf"]]),U=K;B()(f,"components",{QPage:y.A,QIcon:L.A,QBadge:P.A,QForm:q.A,QInput:E.A,QBtn:F.A,QBanner:S.A})}}]);