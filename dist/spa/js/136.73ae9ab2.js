"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[136],{1136:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Q});var n=t(1758),l=t(8790),i=t(8734),s=t(3394),r=t(4907),c=t(7677);const o={class:"header-bar"},d={class:"nav-row"},u={class:"due-badge"},v={class:"period-text"},k={class:"meter-section","data-test":"electricity-meter-section"},p={class:"meter-type-header"},g={class:"meter-number"},y={class:"reading-history"},m={class:"reading-row"},b={class:"reading-label"},L={class:"reading-value"},E={class:"date-selector-section"},h={class:"digit-display-container"},_={class:"digit-group black-group active","data-test":"electricity-group"},D={class:"digits black"},C={key:0,class:"cursor-blink"},R={class:"keypad-container","data-test":"keypad"},f={class:"keypad-grid"},w=["data-test","onClick"],A={class:"back-button-container"},I={__name:"ElectricityReadingPage",setup(e){const a=(0,s.rd)(),t=(0,r.A)(),I=(0,i.KR)(null),S=(0,i.KR)(null),W=(0,i.KR)(null),B=(0,i.KR)(""),G=(0,i.KR)((new Date).toISOString().split("T")[0]),T=["1","2","3","4","5","6","7","8","9","clear","0","backspace"];(0,n.sV)(()=>{c.Ay.initializeSeedData(),W.value=c.Ay.getDashboardData()});const K=(0,n.EW)(()=>W.value?.electricity?.meterNumber||"98736"),N=(0,n.EW)(()=>{if(!W.value?.electricity?.startReading?.date)return"10th April";const e=new Date(W.value.electricity.startReading.date);return e.toLocaleDateString("en-GB",{day:"numeric",month:"long"})}),F=(0,n.EW)(()=>W.value?.electricity?.startReading?.value||"763456"),Q=(0,n.EW)(()=>{const e=new Date;return e.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),q=(0,n.EW)(()=>W.value?.period?.daysUntilDue||17),P=(0,n.EW)(()=>{if(!W.value?.period?.startDate)return"10 Apr 2025";const e=new Date(W.value.period.startDate);return e.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),V=(0,n.EW)(()=>{if(!W.value?.period?.endDate)return"10 May 2025";const e=new Date(W.value.period.endDate);return e.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),x=(0,n.EW)(()=>B.value||"0"),M=()=>{console.log("Go to previous period")},X=()=>{console.log("Go to next period")},$=()=>{a.back()},z=e=>{if("backspace"===e)O();else if("clear"===e)Y();else{if("."===e)return;U(e)}},U=e=>{B.value.length<6&&(B.value+=e)},O=()=>{B.value=B.value.slice(0,-1)},Y=()=>{B.value=""},j=()=>{B.value="",a.back()},H=()=>{const e=x.value,n=parseInt(e,10),l=c.Ay.getCurrentBillingPeriod();c.Ay.saveElectricityReading({meterId:"EM-98736",periodId:l?.id||"period-2025-04",value:e,kwh:n,type:"end",isEstimated:!1,date:G.value});const i=new Date(G.value).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"});t.notify({type:"positive",message:`Electricity reading saved: ${e} on ${i}`,position:"top"}),a.push({name:"home"})};return(e,a)=>{const t=(0,n.g2)("q-icon"),i=(0,n.g2)("q-input"),s=(0,n.g2)("q-btn"),r=(0,n.g2)("q-page");return(0,n.uX)(),(0,n.Wv)(r,{class:"electricity-reading-page","data-test":"electricity-reading-page"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",o,[(0,n.Lk)("span",null,"Current date: "+(0,l.v_)(Q.value),1)]),(0,n.Lk)("div",d,[(0,n.Lk)("button",{class:"nav-arrow",onClick:M},[...a[1]||(a[1]=[(0,n.Lk)("span",{class:"arrow-icon"},"◀",-1)])]),(0,n.Lk)("div",u," Final Reading due in "+(0,l.v_)(q.value)+" days ",1),(0,n.Lk)("button",{class:"nav-arrow",onClick:X},[...a[2]||(a[2]=[(0,n.Lk)("span",{class:"arrow-icon"},"▶",-1)])])]),a[6]||(a[6]=(0,n.Lk)("div",{class:"page-title"},"ENTER ELECTRICITY READING",-1)),(0,n.Lk)("div",v,"Period - "+(0,l.v_)(P.value)+" to "+(0,l.v_)(V.value),1),(0,n.Lk)("div",{class:"content-scroll",ref_key:"contentScrollRef",ref:I},[(0,n.Lk)("div",k,[(0,n.Lk)("div",p,[(0,n.bF)(t,{name:"bolt",size:"24px",class:"meter-icon"}),a[3]||(a[3]=(0,n.Lk)("span",{class:"meter-type-name"},"Electricity",-1))]),(0,n.Lk)("div",g,"Meter Number #"+(0,l.v_)(K.value),1),(0,n.Lk)("div",y,[(0,n.Lk)("div",m,[(0,n.Lk)("span",b,"Start Reading "+(0,l.v_)(N.value),1),(0,n.Lk)("span",L,(0,l.v_)(F.value),1)])]),(0,n.Lk)("div",E,[a[4]||(a[4]=(0,n.Lk)("label",{class:"date-label"},"Reading Date:",-1)),(0,n.bF)(i,{modelValue:G.value,"onUpdate:modelValue":a[0]||(a[0]=e=>G.value=e),type:"date",filled:"",dense:"",class:"date-input","data-test":"reading-date-input"},null,8,["modelValue"])]),(0,n.Lk)("div",{class:"digit-input-section",ref_key:"electricityDigitRef",ref:S},[(0,n.Lk)("div",h,[(0,n.Lk)("div",_,[(0,n.Lk)("span",D,(0,l.v_)(x.value),1),""===B.value?((0,n.uX)(),(0,n.CE)("span",C,"|")):(0,n.Q3)("",!0)])])],512)]),a[5]||(a[5]=(0,n.Lk)("div",{class:"keypad-spacer"},null,-1))],512),(0,n.Lk)("div",R,[(0,n.Lk)("div",f,[((0,n.uX)(),(0,n.CE)(n.FK,null,(0,n.pI)(T,e=>(0,n.Lk)("button",{key:e,class:(0,l.C4)(["keypad-btn",{"clear-btn":"clear"===e}]),"data-test":`keypad-${e}`,onClick:a=>z(e)},(0,l.v_)("backspace"===e?"⌫":"clear"===e?"C":e),11,w)),64))]),(0,n.Lk)("div",{class:"keypad-actions"},[(0,n.Lk)("button",{class:"action-btn cancel",onClick:j,"data-test":"keypad-cancel"}," CANCEL "),(0,n.Lk)("button",{class:"action-btn enter",onClick:H,"data-test":"keypad-enter"}," ENTER ")])]),(0,n.Lk)("div",A,[(0,n.bF)(s,{flat:"",color:"primary",label:"Back",icon:"arrow_back",onClick:$,"data-test":"back-button"})])]),_:1})}}};var S=t(2807),W=t(7716),B=t(492),G=t(9270),T=t(6384),K=t(8582),N=t.n(K);const F=(0,S.A)(I,[["__scopeId","data-v-61e42db8"]]),Q=F;N()(I,"components",{QPage:W.A,QIcon:B.A,QInput:G.A,QBtn:T.A})}}]);