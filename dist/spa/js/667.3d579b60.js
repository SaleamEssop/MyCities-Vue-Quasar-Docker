"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[667],{3667:(e,t,a)=>{a.r(t),a.d(t,{default:()=>O});a(310),a(5962),a(199),a(7346);var n=a(1758),c=a(8790),l=a(9104),o=a(8734),s=a(3394),i=a(4907),u=a(3009);const r={class:"select-container"},d={class:"header-section"},m={class:"welcome-text"},v={class:"welcome-title"},g={class:"create-new-section"},p={class:"accounts-grid"},k=["onClick"],f={class:"card-content"},b={class:"account-name"},_={key:0,class:"no-accounts"},y={key:1,class:"continue-section"},h={class:"logout-section"},C={__name:"AccountSelectPage",setup(e){const t=(0,s.rd)(),a=(0,i.A)(),C=(0,u.useUserStore)(),F=(0,o.KR)(null),A=(0,o.KR)(!1),L=(0,o.KR)(null),Q=(0,n.EW)(()=>{const e=C.getUser;return e?.name||e?.email?.split("@")[0]||"User"}),q=(0,o.KR)([{id:1,name:"Main House",description:"Primary residence",region:"Durban"},{id:2,name:"Out Building",description:"Granny flat",region:"Durban"}]);function S(){const e=localStorage.getItem("mycities_user_accounts");if(e)try{q.value=JSON.parse(e)}catch(e){console.error("Failed to parse accounts:",e)}1===q.value.length&&(F.value=q.value[0].id)}function w(e){F.value=e.id,localStorage.setItem("mycities_selected_account",e.id),a.notify({type:"positive",message:`Account "${e.name}" selected`,position:"top"}),t.push({name:"home"})}function I(){F.value&&(localStorage.setItem("mycities_selected_account",F.value),a.notify({type:"positive",message:"Account selected",position:"top"}),t.push({name:"home"}))}function D(){t.push({name:"account-new"})}function W(e){t.push({name:"account-edit",params:{accountId:e.id}})}function X(e){L.value=e,A.value=!0}function x(){L.value&&(q.value=q.value.filter(e=>e.id!==L.value.id),localStorage.setItem("mycities_user_accounts",JSON.stringify(q.value)),F.value===L.value.id&&(F.value=null),a.notify({type:"positive",message:`${L.value.name} deleted`,position:"top"}),A.value=!1,L.value=null)}function E(){C.signOut(),a.notify({type:"info",message:"Signed out successfully",position:"top"}),t.push({name:"login"})}return(0,n.sV)(()=>{S()}),(e,t)=>{const a=(0,n.g2)("q-icon"),o=(0,n.g2)("q-item-section"),s=(0,n.g2)("q-item"),i=(0,n.g2)("q-list"),u=(0,n.g2)("q-menu"),C=(0,n.g2)("q-btn"),S=(0,n.g2)("q-card-section"),K=(0,n.g2)("q-card-actions"),$=(0,n.g2)("q-card"),N=(0,n.g2)("q-dialog"),O=(0,n.g2)("q-page"),P=(0,n.gN)("close-popup");return(0,n.uX)(),(0,n.Wv)(O,{class:"account-select-page"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",r,[(0,n.Lk)("div",d,[(0,n.Lk)("div",m,[(0,n.Lk)("h1",v,"Welcome, "+(0,c.v_)(Q.value),1)])]),(0,n.Lk)("div",g,[(0,n.Lk)("a",{href:"#",class:"create-link",onClick:(0,l.D$)(D,["prevent"]),"data-test":"account-select-create"}," Create a new account ")]),(0,n.Lk)("div",p,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(q.value,e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:(0,c.C4)(["account-card",{selected:F.value===e.id}]),onClick:t=>w(e),"data-test":"account-card"},[(0,n.Lk)("div",f,[(0,n.Lk)("span",b,(0,c.v_)(e.name),1)]),(0,n.bF)(C,{flat:"",round:"",dense:"",icon:"more_vert",class:"menu-btn",onClick:t[0]||(t[0]=(0,l.D$)(()=>{},["stop"])),"data-test":"account-menu-btn"},{default:(0,n.k6)(()=>[(0,n.bF)(u,{anchor:"bottom right",self:"top right"},{default:(0,n.k6)(()=>[(0,n.bF)(i,{style:{"min-width":"150px"}},{default:(0,n.k6)(()=>[(0,n.bo)(((0,n.uX)(),(0,n.Wv)(s,{clickable:"",onClick:t=>W(e),"data-test":"account-edit"},{default:(0,n.k6)(()=>[(0,n.bF)(o,{avatar:""},{default:(0,n.k6)(()=>[(0,n.bF)(a,{name:"edit",color:"primary"})]),_:1}),(0,n.bF)(o,null,{default:(0,n.k6)(()=>[...t[2]||(t[2]=[(0,n.eW)("Edit",-1)])]),_:1})]),_:1},8,["onClick"])),[[P]]),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(s,{clickable:"",onClick:t=>X(e),"data-test":"account-delete"},{default:(0,n.k6)(()=>[(0,n.bF)(o,{avatar:""},{default:(0,n.k6)(()=>[(0,n.bF)(a,{name:"delete",color:"negative"})]),_:1}),(0,n.bF)(o,{class:"text-negative"},{default:(0,n.k6)(()=>[...t[3]||(t[3]=[(0,n.eW)("Delete",-1)])]),_:1})]),_:1},8,["onClick"])),[[P]])]),_:2},1024)]),_:2},1024)]),_:2},1024)],10,k))),128))]),0===q.value.length?((0,n.uX)(),(0,n.CE)("div",_,[(0,n.bF)(a,{name:"account_balance",size:"64px",color:"grey-5"}),t[4]||(t[4]=(0,n.Lk)("p",null,"No accounts yet",-1)),(0,n.bF)(C,{color:"primary",label:"Create Your First Account",onClick:D,"data-test":"account-select-create-first"})])):(0,n.Q3)("",!0),F.value&&q.value.length>0?((0,n.uX)(),(0,n.CE)("div",y,[(0,n.bF)(C,{color:"primary",label:"Continue",class:"continue-btn",onClick:I,"data-test":"account-select-continue"})])):(0,n.Q3)("",!0),(0,n.Lk)("div",h,[(0,n.Lk)("a",{href:"#",class:"logout-link",onClick:(0,l.D$)(E,["prevent"]),"data-test":"account-select-logout"}," Sign out ")])]),(0,n.bF)(N,{modelValue:A.value,"onUpdate:modelValue":t[1]||(t[1]=e=>A.value=e),persistent:""},{default:(0,n.k6)(()=>[(0,n.bF)($,{style:{"min-width":"300px"}},{default:(0,n.k6)(()=>[(0,n.bF)(S,null,{default:(0,n.k6)(()=>[...t[5]||(t[5]=[(0,n.Lk)("div",{class:"text-h6"},"Delete Account",-1)])]),_:1}),(0,n.bF)(S,{class:"q-pt-none"},{default:(0,n.k6)(()=>[t[6]||(t[6]=(0,n.eW)(" Are you sure you want to delete ",-1)),(0,n.Lk)("strong",null,(0,c.v_)(L.value?.name),1),t[7]||(t[7]=(0,n.eW)("? This action cannot be undone. ",-1))]),_:1}),(0,n.bF)(K,{align:"right"},{default:(0,n.k6)(()=>[(0,n.bo)((0,n.bF)(C,{flat:"",label:"Cancel",color:"grey"},null,512),[[P]]),(0,n.bF)(C,{flat:"",label:"Delete",color:"negative",onClick:x,"data-test":"account-delete-confirm"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};var F=a(2807),A=a(7716),L=a(6384),Q=a(4436),q=a(3999),S=a(124),w=a(5173),I=a(492),D=a(2156),W=a(3316),X=a(4189),x=a(2669),E=a(8672),K=a(8582),$=a.n(K);const N=(0,F.A)(C,[["__scopeId","data-v-48e2025e"]]),O=N;$()(C,"components",{QPage:A.A,QBtn:L.A,QMenu:Q.A,QList:q.A,QItem:S.A,QItemSection:w.A,QIcon:I.A,QDialog:D.A,QCard:W.A,QCardSection:X.A,QCardActions:x.A}),$()(C,"directives",{ClosePopup:E.A})}}]);