"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[601],{3601:(e,a,l)=>{l.r(a),l.d(a,{default:()=>z});var t=l(1758),s=l(8790),n=l(8734),i=l(3394),o=l(780),r=l(4907);const d={class:"page-content"},u={key:0,class:"loading-state"},c={key:1,class:"error-state"},v={key:2,class:"reading-details"},g={class:"page-header"},p={class:"page-subtitle"},k={class:"reading-display"},m={class:"reading-value-large"},b={class:"reading-breakdown"},L={class:"breakdown-item"},_={class:"value kiloliters"},y={class:"breakdown-item"},f={class:"value liters"},h={class:"metadata-row"},w={class:"metadata-value"},F={class:"metadata-row"},A={class:"metadata-value"},C={key:0,class:"metadata-row"},D={class:"metadata-value metadata-id"},Q={class:"actions"},q={__name:"ReadingPreviewPage",setup(e){const a=(0,i.lq)(),l=(0,i.rd)(),q=(0,r.A)(),R=(0,n.KR)(null),$=(0,n.KR)(!0),x=(0,n.KR)(null),E=(0,n.KR)(!1),K=()=>{const e=a.params.id;if(!e)return x.value="No reading ID provided",void($.value=!1);const l=(0,o.xk)(e);if(!l)return x.value="Reading not found",void($.value=!1);R.value=l,$.value=!1},S=e=>{const a=e.kiloliters||"0",l=e.liters||"0";return`${a} - ${l}`},X=e=>{if(!e)return"Unknown date";const a=new Date(e),l=new Date,t=l-a,s=Math.floor(t/6e4),n=Math.floor(t/36e5),i=Math.floor(t/864e5);return s<1?"Just now":s<60?`${s} minute${1!==s?"s":""} ago`:n<24?`${n} hour${1!==n?"s":""} ago`:1===i?"Yesterday":i<7?`${i} days ago`:a.toLocaleDateString("en-ZA",{day:"numeric",month:"short",year:a.getFullYear()!==l.getFullYear()?"numeric":void 0})},I=e=>{if(!e)return"Unknown date";const a=new Date(e);return a.toLocaleDateString("en-ZA",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})},M=()=>{l.push({name:"meter-input"})},P=()=>{E.value=!0},T=()=>{if(!R.value)return;const e=(0,o.ax)(R.value.id);e?(q.notify({type:"positive",message:"Reading deleted",position:"top"}),l.push({name:"readings-list"})):q.notify({type:"negative",message:"Failed to delete reading",position:"top"}),E.value=!1},V=()=>{l.push({name:"readings-list"})};return(0,t.sV)(()=>{K()}),(e,a)=>{const l=(0,t.g2)("q-spinner"),n=(0,t.g2)("q-icon"),i=(0,t.g2)("q-btn"),o=(0,t.g2)("q-card-section"),r=(0,t.g2)("q-card"),q=(0,t.g2)("q-scroll-area"),K=(0,t.g2)("q-card-actions"),U=(0,t.g2)("q-dialog"),Y=(0,t.g2)("q-page"),z=(0,t.gN)("close-popup");return(0,t.uX)(),(0,t.Wv)(Y,{class:"reading-preview-page"},{default:(0,t.k6)(()=>[(0,t.bF)(q,{class:"page-scroll-area"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",d,[$.value?((0,t.uX)(),(0,t.CE)("div",u,[(0,t.bF)(l,{color:"primary",size:"48px"}),a[1]||(a[1]=(0,t.Lk)("p",null,"Loading reading...",-1))])):x.value?((0,t.uX)(),(0,t.CE)("div",c,[(0,t.bF)(n,{name:"error_outline",size:"64px",color:"negative"}),(0,t.Lk)("p",null,(0,s.v_)(x.value),1),(0,t.bF)(i,{color:"primary",label:"Back to List",onClick:V})])):R.value?((0,t.uX)(),(0,t.CE)("div",v,[(0,t.Lk)("div",g,[a[2]||(a[2]=(0,t.Lk)("h1",{class:"page-title"},"Reading Details",-1)),(0,t.Lk)("p",p,(0,s.v_)(X(R.value.timestamp)),1)]),(0,t.Lk)("div",k,[(0,t.Lk)("div",m,(0,s.v_)(S(R.value)),1),(0,t.Lk)("div",b,[(0,t.Lk)("div",L,[a[3]||(a[3]=(0,t.Lk)("span",{class:"label"},"Kiloliters",-1)),(0,t.Lk)("span",_,(0,s.v_)(R.value.kiloliters||"0"),1)]),a[5]||(a[5]=(0,t.Lk)("div",{class:"breakdown-separator"},"-",-1)),(0,t.Lk)("div",y,[a[4]||(a[4]=(0,t.Lk)("span",{class:"label"},"Liters",-1)),(0,t.Lk)("span",f,(0,s.v_)(R.value.liters||"0"),1)])])]),(0,t.bF)(r,{class:"metadata-card"},{default:(0,t.k6)(()=>[(0,t.bF)(o,null,{default:(0,t.k6)(()=>[(0,t.Lk)("div",h,[a[6]||(a[6]=(0,t.Lk)("span",{class:"metadata-label"},"Type",-1)),(0,t.Lk)("span",w,(0,s.v_)(R.value.type||"Manual"),1)]),(0,t.Lk)("div",F,[a[7]||(a[7]=(0,t.Lk)("span",{class:"metadata-label"},"Date",-1)),(0,t.Lk)("span",A,(0,s.v_)(I(R.value.timestamp)),1)]),R.value.id?((0,t.uX)(),(0,t.CE)("div",C,[a[8]||(a[8]=(0,t.Lk)("span",{class:"metadata-label"},"ID",-1)),(0,t.Lk)("span",D,(0,s.v_)(R.value.id),1)])):(0,t.Q3)("",!0)]),_:1})]),_:1}),(0,t.Lk)("div",Q,[(0,t.bF)(i,{color:"primary",label:"Edit Reading",icon:"edit",onClick:M}),(0,t.bF)(i,{color:"negative",outline:"",label:"Delete",icon:"delete",onClick:P})])])):(0,t.Q3)("",!0)])]),_:1}),(0,t.bF)(U,{modelValue:E.value,"onUpdate:modelValue":a[0]||(a[0]=e=>E.value=e)},{default:(0,t.k6)(()=>[(0,t.bF)(r,null,{default:(0,t.k6)(()=>[(0,t.bF)(o,null,{default:(0,t.k6)(()=>[...a[9]||(a[9]=[(0,t.Lk)("div",{class:"text-h6"},"Delete Reading?",-1)])]),_:1}),(0,t.bF)(o,null,{default:(0,t.k6)(()=>[...a[10]||(a[10]=[(0,t.Lk)("p",null,"Are you sure you want to delete this reading? This action cannot be undone.",-1)])]),_:1}),(0,t.bF)(K,{align:"right"},{default:(0,t.k6)(()=>[(0,t.bo)((0,t.bF)(i,{flat:"",label:"Cancel",color:"primary"},null,512),[[z]]),(0,t.bF)(i,{flat:"",label:"Delete",color:"negative",onClick:T})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};var R=l(2807),$=l(7716),x=l(8958),E=l(564),K=l(492),S=l(6384),X=l(3316),I=l(4189),M=l(2156),P=l(2669),T=l(8672),V=l(8582),U=l.n(V);const Y=(0,R.A)(q,[["__scopeId","data-v-d91777d8"]]),z=Y;U()(q,"components",{QPage:$.A,QScrollArea:x.A,QSpinner:E.A,QIcon:K.A,QBtn:S.A,QCard:X.A,QCardSection:I.A,QDialog:M.A,QCardActions:P.A}),U()(q,"directives",{ClosePopup:T.A})}}]);