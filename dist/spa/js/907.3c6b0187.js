"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[907],{8907:(e,a,t)=>{t.r(a),t.d(a,{default:()=>he});var s=t(1758),l=t(8790),r=t(9104),i=t(8734),c=t(3394),o=t(7677);const n={class:"header-section"},v={class:"current-date","data-test":"current-date"},d={class:"nav-row"},u=["disabled"],k=["disabled"],p={class:"amount-display","data-test":"total-amount"},g={class:"period-display","data-test":"billing-period"},L={class:"content-section"},h={class:"meter-section","data-test":"water-section"},m={class:"meter-header"},b={class:"meter-icon"},w={class:"meter-stats"},_={class:"stat-item"},y={class:"stat-value"},C={class:"stat-item"},D={class:"stat-value"},W={class:"stat-item"},E={class:"stat-value"},j={class:"action-links"},F={key:0,class:"charges-breakdown"},x={class:"charge-row"},R={class:"charge-value"},f={class:"charge-row"},A={class:"charge-value"},K={class:"charge-row"},P={class:"charge-value"},B={class:"charge-row projected"},$={class:"charge-value"},I={class:"meter-section","data-test":"electricity-section"},S={class:"meter-header"},T={class:"meter-icon electricity"},U={class:"meter-stats"},X={class:"stat-item"},H={class:"stat-value"},Q={class:"stat-item"},V={class:"stat-value"},z={class:"stat-item"},G={class:"stat-value"},q={class:"action-links"},N={key:0,class:"charges-breakdown"},J={class:"charge-row"},M={class:"charge-value"},O={class:"charge-row projected"},Y={class:"charge-value"},Z={class:"additional-charges-section"},ee={class:"charge-label"},ae={class:"charge-value"},te={class:"charge-item"},se={class:"charge-value"},le={class:"charge-item"},re={class:"charge-value"},ie={class:"charge-item projected"},ce={class:"charge-value"},oe={class:"total-row"},ne={class:"total-value"},ve={__name:"DashboardPage",setup(e){const a=(0,c.rd)(),t=(0,i.KR)(0),ve=(0,i.KR)([]),de=(0,i.KR)(null),ue=(0,i.KR)(!0),ke=(0,i.KR)(!1),pe=(0,s.EW)(()=>{const e=new Date;return e.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),ge=(0,s.EW)(()=>de.value?.period?.daysUntilDue||0),Le=(0,s.EW)(()=>ge.value<=3?"urgent":ge.value<=7?"warning":"normal"),he=(0,s.EW)(()=>{const e=parseFloat(Fe.value)||0,a=parseFloat(Ke.value)||0,t=parseFloat($e.value)||0,s=e+a+t;return s.toFixed(2)}),me=(0,s.EW)(()=>{if(!de.value?.period?.startDate)return"";const e=new Date(de.value.period.startDate);return e.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),be=(0,s.EW)(()=>{if(!de.value?.period?.endDate)return"";const e=new Date(de.value.period.endDate);return e.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),we=(0,s.EW)(()=>t.value<ve.value.length-1),_e=(0,s.EW)(()=>t.value>0),ye=(0,s.EW)(()=>de.value?.water?.dailyAverage||"0 L"),Ce=(0,s.EW)(()=>{const e=de.value?.projections;return e?`${e.water.projectedUsageKl.toFixed(2)} KL`:"0.00 KL"}),De=(0,s.EW)(()=>{const e=de.value?.projections;if(!e)return"0.00";const a=e.water.projectedCost/(de.value?.period?.daysInPeriod||30);return a.toFixed(2)}),We=(0,s.EW)(()=>de.value?.projections?.water?.projectedConsumption?.toFixed(2)||"0.00"),Ee=(0,s.EW)(()=>de.value?.projections?.water?.projectedDischarge?.toFixed(2)||"0.00"),je=(0,s.EW)(()=>de.value?.projections?.water?.projectedInfrastructure?.toFixed(2)||"0.00"),Fe=(0,s.EW)(()=>de.value?.projections?.water?.projectedCost?.toFixed(2)||"0.00"),xe=(0,s.EW)(()=>de.value?.electricity?.dailyAverage||"0 kWh"),Re=(0,s.EW)(()=>{const e=de.value?.projections;return e?`${e.electricity.projectedUsageKwh} kWh`:"0 kWh"}),fe=(0,s.EW)(()=>{const e=de.value?.projections;if(!e)return"0.00";const a=e.electricity.projectedCost/(de.value?.period?.daysInPeriod||30);return a.toFixed(2)}),Ae=(0,s.EW)(()=>de.value?.projections?.electricity?.projectedConsumption?.toFixed(2)||"0.00"),Ke=(0,s.EW)(()=>de.value?.projections?.electricity?.projectedCost?.toFixed(2)||"0.00"),Pe=(0,s.EW)(()=>de.value?.bill?.fixedCosts?.total||0),Be=(0,s.EW)(()=>de.value?.bill?.fixedCosts?.items||[]),$e=(0,s.EW)(()=>{const e=Pe.value,a=parseFloat(Ie.value)||0,t=parseFloat(Se.value)||0;return(e+a+t).toFixed(2)}),Ie=(0,s.EW)(()=>{const e=de.value?.projections,a=de.value?.bill;if(!e||!a)return"0.00";const t=e.water?.projectedCost||0,s=e.electricity?.projectedCost||0,l=a.fixedCosts?.total||0,r=t+s+l,i=a.vat?.percentage||15,c=r*(i/100);return c.toFixed(2)}),Se=(0,s.EW)(()=>de.value?.bill?.customerCosts?.total?.toFixed(2)||"0.00"),Te=()=>{const e=ve.value[t.value]?.id;de.value=o.Ay.getDashboardData(e)},Ue=()=>{we.value&&(t.value++,Te())},Xe=()=>{_e.value&&(t.value--,Te())},He=()=>{ue.value=!ue.value},Qe=()=>{ke.value=!ke.value},Ve=()=>{a.push({name:"water-reading"})},ze=()=>{a.push({name:"electricity-reading"})},Ge=()=>{a.push({name:"readings-list"})},qe=()=>{a.push({name:"readings-list"})};return(0,s.sV)(()=>{o.Ay.initializeSeedData(),ve.value=o.Ay.getBillingPeriods(),Te(),console.log("Dashboard Data:",de.value),console.log("Bill Breakdown:",de.value?.bill)}),(e,a)=>{const t=(0,s.g2)("q-icon"),i=(0,s.g2)("q-page");return(0,s.uX)(),(0,s.Wv)(i,{class:"dashboard-page","data-test":"dashboard-page"},{default:(0,s.k6)(()=>[(0,s.Lk)("div",n,[(0,s.Lk)("div",v," Current date: "+(0,l.v_)(pe.value),1),(0,s.Lk)("div",d,[(0,s.Lk)("button",{class:"nav-arrow",onClick:Ue,disabled:!we.value,"data-test":"nav-previous","aria-label":"Previous period"},[...a[0]||(a[0]=[(0,s.Lk)("span",{class:"arrow-icon"},"◀",-1)])],8,u),(0,s.Lk)("div",{class:(0,l.C4)(["due-badge",Le.value]),"data-test":"due-badge"},[a[1]||(a[1]=(0,s.eW)(" Final Reading due in ",-1)),(0,s.Lk)("strong",null,(0,l.v_)(ge.value),1),a[2]||(a[2]=(0,s.eW)(" days ",-1))],2),(0,s.Lk)("button",{class:"nav-arrow",onClick:Xe,disabled:!_e.value,"data-test":"nav-next","aria-label":"Next period"},[...a[3]||(a[3]=[(0,s.Lk)("span",{class:"arrow-icon"},"▶",-1)])],8,k)]),(0,s.Lk)("div",p,[a[4]||(a[4]=(0,s.Lk)("span",{class:"currency"},"R",-1)),(0,s.eW)((0,l.v_)(he.value),1)]),(0,s.Lk)("div",g," Period - "+(0,l.v_)(me.value)+" to "+(0,l.v_)(be.value),1)]),(0,s.Lk)("div",L,[(0,s.Lk)("div",h,[(0,s.Lk)("div",m,[(0,s.Lk)("div",b,[(0,s.bF)(t,{name:"water_drop",size:"24px"})]),(0,s.Lk)("div",w,[(0,s.Lk)("div",_,[a[5]||(a[5]=(0,s.Lk)("div",{class:"stat-label"},"Daily Usage",-1)),(0,s.Lk)("div",y,(0,l.v_)(ye.value),1)]),(0,s.Lk)("div",C,[a[6]||(a[6]=(0,s.Lk)("div",{class:"stat-label"},"Total Usage",-1)),(0,s.Lk)("div",D,(0,l.v_)(Ce.value),1)]),(0,s.Lk)("div",W,[a[7]||(a[7]=(0,s.Lk)("div",{class:"stat-label"},"Daily Cost",-1)),(0,s.Lk)("div",E,"R "+(0,l.v_)(De.value),1)])])]),(0,s.Lk)("div",j,[(0,s.Lk)("a",{href:"#",onClick:(0,r.D$)(Ve,["prevent"]),"data-test":"water-enter-reading"}," Enter reading "),(0,s.Lk)("a",{href:"#",onClick:(0,r.D$)(Ge,["prevent"]),"data-test":"water-view-history"}," View History "),(0,s.Lk)("a",{href:"#",onClick:(0,r.D$)(He,["prevent"]),"data-test":"water-toggle-details"},(0,l.v_)(ue.value?"Hide Details":"Show Details"),1)]),(0,s.bF)(r.eB,{name:"slide"},{default:(0,s.k6)(()=>[ue.value?((0,s.uX)(),(0,s.CE)("div",F,[(0,s.Lk)("div",x,[a[8]||(a[8]=(0,s.Lk)("span",{class:"charge-label"},"Consumption Charges",-1)),(0,s.Lk)("span",R,"R"+(0,l.v_)(We.value),1)]),(0,s.Lk)("div",f,[a[9]||(a[9]=(0,s.Lk)("span",{class:"charge-label"},"Discharge charges",-1)),(0,s.Lk)("span",A,"R"+(0,l.v_)(Ee.value),1)]),(0,s.Lk)("div",K,[a[10]||(a[10]=(0,s.Lk)("span",{class:"charge-label"},"Infrastructure Surcharge",-1)),(0,s.Lk)("span",P,"R"+(0,l.v_)(je.value),1)]),(0,s.Lk)("div",B,[a[11]||(a[11]=(0,s.Lk)("span",{class:"charge-label"},"Projected charges",-1)),(0,s.Lk)("span",$,"→ R "+(0,l.v_)(Fe.value),1)])])):(0,s.Q3)("",!0)]),_:1})]),(0,s.Lk)("div",I,[(0,s.Lk)("div",S,[(0,s.Lk)("div",T,[(0,s.bF)(t,{name:"bolt",size:"24px"})]),(0,s.Lk)("div",U,[(0,s.Lk)("div",X,[a[12]||(a[12]=(0,s.Lk)("div",{class:"stat-label"},"Daily Usage",-1)),(0,s.Lk)("div",H,(0,l.v_)(xe.value),1)]),(0,s.Lk)("div",Q,[a[13]||(a[13]=(0,s.Lk)("div",{class:"stat-label"},"Total Usage",-1)),(0,s.Lk)("div",V,(0,l.v_)(Re.value),1)]),(0,s.Lk)("div",z,[a[14]||(a[14]=(0,s.Lk)("div",{class:"stat-label"},"Daily Cost",-1)),(0,s.Lk)("div",G,"R "+(0,l.v_)(fe.value),1)])])]),(0,s.Lk)("div",q,[(0,s.Lk)("a",{href:"#",onClick:(0,r.D$)(ze,["prevent"]),"data-test":"elec-enter-reading"}," Enter reading "),(0,s.Lk)("a",{href:"#",onClick:(0,r.D$)(qe,["prevent"]),"data-test":"elec-view-history"}," View History "),(0,s.Lk)("a",{href:"#",onClick:(0,r.D$)(Qe,["prevent"]),"data-test":"elec-toggle-details"},(0,l.v_)(ke.value?"Hide Details":"Show Details"),1)]),(0,s.bF)(r.eB,{name:"slide"},{default:(0,s.k6)(()=>[ke.value?((0,s.uX)(),(0,s.CE)("div",N,[(0,s.Lk)("div",J,[a[15]||(a[15]=(0,s.Lk)("span",{class:"charge-label"},"Consumption Charges",-1)),(0,s.Lk)("span",M,"R"+(0,l.v_)(Ae.value),1)]),(0,s.Lk)("div",O,[a[16]||(a[16]=(0,s.Lk)("span",{class:"charge-label"},"Projected charges",-1)),(0,s.Lk)("span",Y,"→ R "+(0,l.v_)(Ke.value),1)])])):(0,s.Q3)("",!0)]),_:1})]),(0,s.Lk)("div",Z,[a[20]||(a[20]=(0,s.Lk)("div",{class:"section-title"},"Additional Charges",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Be.value,e=>((0,s.uX)(),(0,s.CE)("div",{class:"charge-item",key:e.name},[(0,s.Lk)("span",ee,(0,l.v_)(e.name),1),(0,s.Lk)("span",ae,"R"+(0,l.v_)(e.value?.toFixed(2)||"0.00"),1)]))),128)),(0,s.Lk)("div",te,[a[17]||(a[17]=(0,s.Lk)("span",{class:"charge-label"},"VAT (15%)",-1)),(0,s.Lk)("span",se,"R"+(0,l.v_)(Ie.value),1)]),(0,s.Lk)("div",le,[a[18]||(a[18]=(0,s.Lk)("span",{class:"charge-label"},"Rates",-1)),(0,s.Lk)("span",re,"R"+(0,l.v_)(Se.value),1)]),(0,s.Lk)("div",ie,[a[19]||(a[19]=(0,s.Lk)("span",{class:"charge-label"},"Additional Charges Total",-1)),(0,s.Lk)("span",ce,"→ R "+(0,l.v_)($e.value),1)])]),(0,s.Lk)("div",oe,[a[21]||(a[21]=(0,s.Lk)("span",{class:"total-label"},"Total",-1)),(0,s.Lk)("span",ne,"R"+(0,l.v_)(he.value),1)])])]),_:1})}}};var de=t(2807),ue=t(7716),ke=t(492),pe=t(8582),ge=t.n(pe);const Le=(0,de.A)(ve,[["__scopeId","data-v-4a29880a"]]),he=Le;ge()(ve,"components",{QPage:ue.A,QIcon:ke.A})}}]);