"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[163],{8163:(e,a,l)=>{l.r(a),l.d(a,{default:()=>ie});l(310),l(5962),l(2203);var s=l(1758),n=l(8790),t=l(8734),r=l(3394),i=l(7677);const d={class:"page-content"},c={class:"page-header"},u={class:"page-subtitle"},o={class:"period-selector"},g={class:"period-label"},v={class:"section-header"},k={class:"meter-number"},p={class:"readings-card"},b={class:"reading-info"},h={class:"reading-label"},y={class:"reading-date"},L={class:"reading-value"},m={class:"red-digits"},E={class:"black-digits"},w={key:0,class:"reading-source"},_={key:0,class:"reading-row pending"},f={class:"reading-info"},C={class:"reading-label"},A={key:1,class:"add-reading-row"},D={key:2,class:"usage-summary"},F={class:"usage-row"},R={class:"usage-value"},W={key:0,class:"usage-row"},X={class:"usage-value"},Q={class:"section-header"},I={class:"meter-number"},B={class:"readings-card"},K={class:"reading-info"},N={class:"reading-label"},S={class:"reading-date"},T={class:"reading-value electricity"},G={class:"digits"},q={key:0,class:"reading-source"},x={key:0,class:"reading-row pending"},U={class:"reading-info"},z={class:"reading-label"},M={key:1,class:"add-reading-row"},P={key:2,class:"usage-summary"},V={class:"usage-row"},O={class:"usage-value"},$={key:0,class:"usage-row"},H={class:"usage-value"},j={class:"action-buttons"},J={class:"back-section"},Y={__name:"ReadingsListPage",setup(e){const a=(0,r.rd)(),l=(0,t.KR)([]),Y=(0,t.KR)(0),Z=(0,t.KR)(null),ee=(0,t.KR)([]),ae=(0,t.KR)([]),le=(0,s.EW)(()=>l.value[Y.value]||null),se=(0,s.EW)(()=>le.value?ee.value.filter(e=>e.periodId===le.value.id).sort((e,a)=>new Date(e.date)-new Date(a.date)):[]),ne=(0,s.EW)(()=>le.value?ae.value.filter(e=>e.periodId===le.value.id).sort((e,a)=>new Date(e.date)-new Date(a.date)):[]),te=((0,s.EW)(()=>le.value?ee.value.find(e=>e.periodId===le.value.id&&"start"===e.type):null),(0,s.EW)(()=>le.value?ee.value.find(e=>e.periodId===le.value.id&&"end"===e.type):null),(0,s.EW)(()=>le.value?ae.value.find(e=>e.periodId===le.value.id&&"start"===e.type):null),(0,s.EW)(()=>le.value?ae.value.find(e=>e.periodId===le.value.id&&"end"===e.type):null),(0,s.EW)(()=>{const e=se.value;if(e.length<1)return"0.00";const a=e[0]?.kiloliters||0,l=e[e.length-1]?.kiloliters||a;return(l-a).toFixed(2)})),re=(0,s.EW)(()=>{const e=ne.value;if(e.length<1)return"0";const a=e[0]?.kwh||0,l=e[e.length-1]?.kwh||a;return(l-a).toLocaleString()}),ie=e=>{if(!e)return"Unknown date";const a=new Date(e);return a.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})},de=e=>{if(!e)return"";const a=new Date(e.startDate),l=new Date(e.endDate),s=a.toLocaleDateString("en-GB",{month:"short",year:"numeric"}),n=l.toLocaleDateString("en-GB",{month:"short",year:"numeric"});return`${s} - ${n}`},ce=()=>{Y.value<l.value.length-1&&Y.value++},ue=()=>{Y.value>0&&Y.value--},oe=()=>{a.push({name:"water-reading"})},ge=()=>{a.push({name:"electricity-reading"})},ve=e=>{switch(e){case"start":return"grey";case"end":return"green";case"reading":return"primary";default:return"grey"}},ke=e=>{switch(e){case"start":return"START";case"end":return"END";case"reading":return"READING";default:return e?.toUpperCase()||"READING"}},pe=()=>{a.push({name:"home"})},be=()=>{i.Ay.initializeSeedData(),l.value=i.Ay.getBillingPeriods(),Z.value=i.Ay.getMeters(),ee.value=i.Ay.getWaterReadings(),ae.value=i.Ay.getElectricityReadings();const e=l.value.findIndex(e=>"current"===e.status);Y.value=e>=0?e:0};return(0,s.sV)(()=>{be()}),(e,a)=>{const t=(0,s.g2)("q-btn"),r=(0,s.g2)("q-icon"),i=(0,s.g2)("q-badge"),ee=(0,s.g2)("q-page");return(0,s.uX)(),(0,s.Wv)(ee,{class:"readings-list-page"},{default:(0,s.k6)(()=>[(0,s.Lk)("div",d,[(0,s.Lk)("div",c,[a[0]||(a[0]=(0,s.Lk)("h1",{class:"page-title"},"Reading History",-1)),(0,s.Lk)("p",u,(0,n.v_)(le.value?.startDate)+" to "+(0,n.v_)(le.value?.endDate),1)]),(0,s.Lk)("div",o,[(0,s.bF)(t,{flat:"",dense:"",icon:"chevron_left",onClick:ce,disable:Y.value>=l.value.length-1},null,8,["disable"]),(0,s.Lk)("span",g,(0,n.v_)(de(le.value)),1),(0,s.bF)(t,{flat:"",dense:"",icon:"chevron_right",onClick:ue,disable:Y.value<=0},null,8,["disable"])]),(0,s.Lk)("div",v,[(0,s.bF)(r,{name:"water_drop",color:"primary",size:"24px"}),a[1]||(a[1]=(0,s.Lk)("span",null,"Water Meter",-1)),(0,s.Lk)("span",k,"#"+(0,n.v_)(Z.value?.water?.number),1)]),(0,s.Lk)("div",p,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(se.value,(e,l)=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:(0,n.C4)(["reading-row",{"first-reading":0===l,"last-reading":l===se.value.length-1}])},[(0,s.Lk)("div",b,[(0,s.Lk)("div",h,[(0,s.bF)(i,{color:ve(e.type),label:ke(e.type),class:"reading-badge"},null,8,["color","label"]),(0,s.Lk)("span",y,(0,n.v_)(ie(e.date)),1)]),(0,s.Lk)("div",L,[(0,s.Lk)("span",m,(0,n.v_)(e.redValue||"0"),1),(0,s.Lk)("span",E,"."+(0,n.v_)(e.blackValue||"0000"),1),a[2]||(a[2]=(0,s.Lk)("span",{class:"unit"},"kl",-1))])]),e.isEstimated?((0,s.uX)(),(0,s.CE)("div",w,[(0,s.bF)(i,{color:"orange",label:"Estimated"})])):(0,s.Q3)("",!0)],2))),128)),0===se.value.length?((0,s.uX)(),(0,s.CE)("div",_,[(0,s.Lk)("div",f,[(0,s.Lk)("div",C,[(0,s.bF)(i,{color:"amber",label:"NO DATA",class:"reading-badge"}),a[3]||(a[3]=(0,s.Lk)("span",{class:"reading-date"},"No readings entered yet",-1))])]),(0,s.bF)(t,{flat:"",dense:"",color:"primary",label:"Enter Reading",onClick:oe})])):(0,s.Q3)("",!0),"current"===le.value?.status&&se.value.length>0?((0,s.uX)(),(0,s.CE)("div",A,[(0,s.bF)(t,{flat:"",dense:"",color:"primary",icon:"add",label:"Add Reading",onClick:oe})])):(0,s.Q3)("",!0),se.value.length>0?((0,s.uX)(),(0,s.CE)("div",D,[(0,s.Lk)("div",F,[a[4]||(a[4]=(0,s.Lk)("span",{class:"usage-label"},"Usage this period:",-1)),(0,s.Lk)("span",R,(0,n.v_)(te.value)+" kl",1)]),se.value.length>1?((0,s.uX)(),(0,s.CE)("div",W,[a[5]||(a[5]=(0,s.Lk)("span",{class:"usage-label"},"Readings count:",-1)),(0,s.Lk)("span",X,(0,n.v_)(se.value.length),1)])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Q,[(0,s.bF)(r,{name:"bolt",color:"orange",size:"24px"}),a[6]||(a[6]=(0,s.Lk)("span",null,"Electricity Meter",-1)),(0,s.Lk)("span",I,"#"+(0,n.v_)(Z.value?.electricity?.number),1)]),(0,s.Lk)("div",B,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(ne.value,(e,l)=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:(0,n.C4)(["reading-row",{"first-reading":0===l,"last-reading":l===ne.value.length-1}])},[(0,s.Lk)("div",K,[(0,s.Lk)("div",N,[(0,s.bF)(i,{color:ve(e.type),label:ke(e.type),class:"reading-badge"},null,8,["color","label"]),(0,s.Lk)("span",S,(0,n.v_)(ie(e.date)),1)]),(0,s.Lk)("div",T,[(0,s.Lk)("span",G,(0,n.v_)(e.value||e.kwh||"0"),1),a[7]||(a[7]=(0,s.Lk)("span",{class:"unit"},"kWh",-1))])]),e.isEstimated?((0,s.uX)(),(0,s.CE)("div",q,[(0,s.bF)(i,{color:"orange",label:"Estimated"})])):(0,s.Q3)("",!0)],2))),128)),0===ne.value.length?((0,s.uX)(),(0,s.CE)("div",x,[(0,s.Lk)("div",U,[(0,s.Lk)("div",z,[(0,s.bF)(i,{color:"amber",label:"NO DATA",class:"reading-badge"}),a[8]||(a[8]=(0,s.Lk)("span",{class:"reading-date"},"No readings entered yet",-1))])]),(0,s.bF)(t,{flat:"",dense:"",color:"primary",label:"Enter Reading",onClick:ge})])):(0,s.Q3)("",!0),"current"===le.value?.status&&ne.value.length>0?((0,s.uX)(),(0,s.CE)("div",M,[(0,s.bF)(t,{flat:"",dense:"",color:"primary",icon:"add",label:"Add Reading",onClick:ge})])):(0,s.Q3)("",!0),ne.value.length>0?((0,s.uX)(),(0,s.CE)("div",P,[(0,s.Lk)("div",V,[a[9]||(a[9]=(0,s.Lk)("span",{class:"usage-label"},"Usage this period:",-1)),(0,s.Lk)("span",O,(0,n.v_)(re.value)+" kWh",1)]),ne.value.length>1?((0,s.uX)(),(0,s.CE)("div",$,[a[10]||(a[10]=(0,s.Lk)("span",{class:"usage-label"},"Readings count:",-1)),(0,s.Lk)("span",H,(0,n.v_)(ne.value.length),1)])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",j,[(0,s.bF)(t,{unelevated:"",color:"primary",icon:"water_drop",label:"Add Water Reading",onClick:oe,class:"action-btn"}),(0,s.bF)(t,{unelevated:"",color:"orange",icon:"bolt",label:"Add Electricity Reading",onClick:ge,class:"action-btn"})]),(0,s.Lk)("div",J,[(0,s.bF)(t,{flat:"",color:"primary",label:"Back to Dashboard",icon:"arrow_back",onClick:pe})])])]),_:1})}}};var Z=l(2807),ee=l(7716),ae=l(6384),le=l(492),se=l(3954),ne=l(8582),te=l.n(ne);const re=(0,Z.A)(Y,[["__scopeId","data-v-924cb0e8"]]),ie=re;te()(Y,"components",{QPage:ee.A,QBtn:ae.A,QIcon:le.A,QBadge:se.A})}}]);