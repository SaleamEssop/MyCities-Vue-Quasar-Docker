"use strict";(globalThis["webpackChunkcom_smart_meter_reading"]=globalThis["webpackChunkcom_smart_meter_reading"]||[]).push([[131],{2999:(e,l,t)=>{t.r(l),t.d(l,{default:()=>y});var a=t(1758),i=t(8790),r=t(8734),s=t(3394),u=t(7033),n=t(9099),o=t(780);const v={class:"page-content"},p={__name:"MeterInputPage",setup(e){const l=(0,s.rd)(),t=(0,r.KR)(null),p=(0,r.KR)(""),c=(0,r.KR)(""),d=(0,r.KR)(null),k=(0,r.KR)(null),g=(0,r.KR)(null),w=(0,r.KR)(null),f=(0,r.KR)(320),y=(0,a.EW)(()=>({height:`calc(100vh - ${f.value}px)`})),h=e=>{t.value=e,(0,a.dY)(()=>{const l="kiloliters"===e?d.value:k.value,t=l?.$el||l;t&&"function"===typeof t.scrollIntoView&&t.scrollIntoView({behavior:"smooth",block:"center"})})},b=e=>{t.value&&("kiloliters"===t.value?p.value+=e:c.value+=e)},m=()=>{t.value&&("kiloliters"===t.value?p.value="":c.value="")},L=()=>{if(!p.value&&!c.value)return;const e={kiloliters:p.value||"0",liters:c.value||"0",type:"manual"};(0,o.yc)(e),l.push({name:"readings-list"})},R=e=>{if(!t.value)return;const l=e.key;"Backspace"===l||"Delete"===l?(m(),e.preventDefault()):"Enter"===l?(L(),e.preventDefault()):/[0-9]/.test(l)?(b(l),e.preventDefault()):"Escape"===l&&(t.value=null,e.preventDefault())},_=()=>{if(window.visualViewport){const e=window.visualViewport.height,l=window.innerHeight,t=l-e;t>50?w.value&&(w.value.style.bottom=`${t}px`):w.value&&(w.value.style.bottom="0")}},K=()=>{if(w.value){const e=w.value.offsetHeight;e>0&&(f.value=e)}};let A=null;return(0,a.sV)(()=>{(0,a.dY)(()=>{K()}),window.addEventListener("keydown",R),window.visualViewport&&window.visualViewport.addEventListener("resize",_),w.value&&window.ResizeObserver&&(A=new ResizeObserver(()=>{K()}),A.observe(w.value)),p.value||c.value||h("kiloliters")}),(0,a.hi)(()=>{window.removeEventListener("keydown",R),window.visualViewport&&window.visualViewport.removeEventListener("resize",_),A&&A.disconnect()}),(0,a.wB)(()=>l.currentRoute.value.name,e=>{}),(e,l)=>{const r=(0,a.g2)("q-scroll-area"),s=(0,a.g2)("q-page");return(0,a.uX)(),(0,a.Wv)(s,{class:"meter-input-page","data-test":"meter-input-page"},{default:(0,a.k6)(()=>[(0,a.bF)(r,{class:"page-scroll-area",style:(0,i.Tr)(y.value)},{default:(0,a.k6)(()=>[(0,a.Lk)("div",v,[l[5]||(l[5]=(0,a.Lk)("div",{class:"page-header"},[(0,a.Lk)("h1",{class:"page-title"},"Water Meter Reading"),(0,a.Lk)("p",{class:"page-subtitle"},"Enter your meter reading")],-1)),(0,a.Lk)("div",{class:"meter-groups",ref_key:"groupsContainerRef",ref:g},[l[2]||(l[2]=(0,a.Lk)("div",{class:"group-label"},"Kiloliters",-1)),(0,a.bF)(u.A,{ref_key:"kilolitersGroupRef",ref:d,type:"kiloliters",value:p.value,"is-active":"kiloliters"===t.value,"aria-label":"Kiloliters input group","data-test":"group-kiloliters",onActivate:l[0]||(l[0]=e=>h("kiloliters"))},null,8,["value","is-active"]),l[3]||(l[3]=(0,a.Lk)("div",{class:"group-separator"},"-",-1)),l[4]||(l[4]=(0,a.Lk)("div",{class:"group-label"},"Liters",-1)),(0,a.bF)(u.A,{ref_key:"litersGroupRef",ref:k,type:"liters",value:c.value,"is-active":"liters"===t.value,"aria-label":"Liters input group","data-test":"group-liters",onActivate:l[1]||(l[1]=e=>h("liters"))},null,8,["value","is-active"])],512),l[6]||(l[6]=(0,a.Lk)("div",{class:"instructions"},[(0,a.Lk)("p",null,"Tap a group to activate it, then use the keypad to enter digits.")],-1))]),(0,a.Lk)("div",{class:"keypad-spacer",style:(0,i.Tr)({height:f.value+"px"})},null,4)]),_:1},8,["style"]),(0,a.Lk)("div",{ref_key:"keypadRef",ref:w,class:"fixed-keypad",style:(0,i.Tr)({height:f.value+"px"}),"data-test":"keypad-container"},[(0,a.bF)(n.A,{"active-group":t.value,onKeypress:b,onClear:m,onEnter:L},null,8,["active-group"])],4)]),_:1})}}};var c=t(2807),d=t(7716),k=t(8958),g=t(8582),w=t.n(g);const f=(0,c.A)(p,[["__scopeId","data-v-028803e8"]]),y=f;w()(p,"components",{QPage:d.A,QScrollArea:k.A})}}]);